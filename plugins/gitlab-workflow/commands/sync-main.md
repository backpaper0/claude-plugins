---
allowed-tools: Bash(git:*)
---

# mainブランチに切り替えて最新化

Merge Requestがマージされた後、mainブランチに切り替えてリポジトリを最新の状態にする。マージ済みのフィーチャーブランチも削除する。

## 手順

### 1. 情報収集（並列実行）

以下のコマンドを**並列で**実行する:

- `git status` — 未コミット変更の確認
- `git rev-parse --abbrev-ref HEAD` — 現在のブランチ名を取得
- `git branch --merged main` — mainにマージ済みのローカルブランチ一覧

### 2. 検証

- 未コミット変更がある場合 → 「未コミットの変更があります。先にコミットまたはスタッシュしてください」と案内して**終了**

### 3. mainブランチへの切り替えと最新化

```
git switch main && git pull
```

### 4. マージ済みブランチの削除

手順1で取得したブランチ情報を元に、マージ済みのブランチ（`main`を除く）をリストアップする。

- マージ済みブランチがない場合 → スキップして手順5へ
- マージ済みブランチがある場合 → 一覧を表示し、削除してよいかユーザーに確認する
- ユーザーが承認したら、各ブランチを `git branch -d <branch-name>` で削除する

### 5. 完了報告

以下の表形式でサマリーを報告する:

| 項目 | 内容 |
|------|------|
| ブランチ | <元のブランチ> → main |
| 削除したブランチ | <削除したブランチ一覧（なければ「なし」）> |

次のアクションをサジェストする:

- `/start-issue <issue番号>` — 次のIssueに着手

## 注意事項

- `git branch -D`（強制削除）は使わない。マージされていないブランチを誤って削除しないようにする
- リモートブランチの削除は行わない（GitLab側のMR設定に任せる）
